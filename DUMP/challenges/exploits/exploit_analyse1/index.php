<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Exploit 2: &quot;Analyse this I!&quot;</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<meta name="author" content="theblacksheep">
<link rel="stylesheet" type="text/css" href="/styles.css"></head><body class="usual"><div class="navline"><a href="/hackchallenge.php" title="Go to the challenge-list."><img src="/files/images/icons/list_small.gif" width="12" height="11" alt="icon" title="Go to the challenge-list." /><span>Challenges</span></a><img src="/files/images/misc/arrow_navline.gif" class="arrow" width="10" height="9" alt="-&gt;" title="" /><span>Exploit</span><img src="/files/images/misc/arrow_navline.gif" class="arrow" width="10" height="9" alt="-&gt;" title="" /><a href="/challenges/exploits/exploit_analyse1/index.php" title="Challenge: &quot;Analyse this I!&quot;"><span>Analyse this I!</span></a></div><div class="module"><div class="chall_header"><table cellspacing="0"><tr><td class="info"><img class="grouppic" alt="a Exploit-challenge" src="/files/images/groupmasters/2_all.gif" height="18" width="25" /><span>Exploit 2: &quot;Analyse this I!&quot;</span></td><td class="links"><table cellspacing="0"><tr><td class="forum"><a href="/challvote.php?challid=8" title="Rate this challenge!"><img src="/files/images/icons/vote_stat_sl.gif" width="16" height="16" alt="vote icon" title="Rate this challenge!" /><span>Vote</span></a></td><td class="forum_space">&nbsp;</td><td class="forum"><a href="/forum/forum_showforum.php?forumid=19&amp;challenge_id=8" title="Visit the Exploit-Forum to ask questions or to find hints for this challenge."><img src="/files/images/misc/challenge_forum_questions.gif" width="16" height="16" alt="forum icon" title="Visit the Exploit-Forum to ask questions or to find hints for this challenge." /><span>Forum</span></a></td><td class="forum_space">&nbsp;</td><td class="forum"><a href="/forum/forum_showforum.php?forumid=31&amp;challenge_id=8" title="Visit the Exploit-Forum for solutions of this challenge."><img src="/files/images/misc/challenge_forum_solutions.gif" width="16" height="16" alt="forum icon" title="Visit the Exploit-Forum for solutions of this challenge." /><span>Solutions</span></a></td><td class="done">done&nbsp;<a href="/challengestats.php?challengeid=8" title="2053 users have solved this challenge so far.">[2053]</a></td></tr></table></td></tr></table></div><div class="challenge_div"><div style="text-align:left">
Hi!<br /><br />
This challenge is about getting around filters, which might make it harder for you to
exploit a script.<br /><br />
What url would you use as parameter if there would be a script "exploitit.php" in the "/user/www/challenges/"
folder of our Linux webserver and you want to open "/user/www/index.php".<br /><br />

In case "exploitit.php" looks like this:<br /><br />

<textarea name"part1" cols="70" rows="10">
  ...
  $url   = str_replace("../","",$_GET['url']);
  $hfile = fopen("/user/www/challenges/$url", "r");
  if(!$hfile){
        echo "Can't open file!";
        exit;
  }
  while (!feof($hfile)){
    $line = fgets ($hfile, 1024);
    echo $line;
  }
  ...</textarea><br /><br />

Or in case"exploitit.php" looks like this:<br /><br />
<textarea name"part2" cols="70" rows="10">
  ...
  if((strpos($_GET['url'],"../") === false) 
     AND (strpos($_GET['url'],"://") === false))){

     $hfile = fopen("$url", "r");
     if(!$hfile){
        echo "Can't open file!";
        exit;
     }
     while (!feof($hfile)){
      $line = fgets ($hfile, 1024);
      echo $line;
     }
  }else{
    echo "Your url got blocked by the filter!";
    }
    ...</textarea><br />
<form action="/challenges/exploits/exploit_analyse1/index.php" method="post">
Answer 1:<input type="text" name="answer1" size="50"><br />
Answer 2:<input type="text" name="answer2" size="50">
<input type="submit" value="Send"></form>
<p><span style="color:FF0000"></span></p><br />
</div>
</div></div></body></html>